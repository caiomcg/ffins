# Installing FFmpeg

There are several ways of installing FFmpeg, you can do it through the CLI, 
downloading pre-compiled versions generated by the community or more appropriately
compiling your own version from the sources. In this tutorial we will compile a new version
from the sources, note that the installation may be different depending on the operating
system you are using. This tutorial will focus on unix systems, in particular MacOS and Linux.

## Downloading from the sources
It is important to download the appropriate version from the sources, FFmpeg has its own repository with a mirror on
github that can be found [here](https://github.com/FFmpeg/FFmpeg).

On the github page you can look at the releases list as shown in the following image.
![Image 01](https://github.com/caiomcg/ffins/blob/master/images/ffmpeg-repo-home.png)

For this tutorial we will use the most recent release **(4.1.3)** as shown in the image below.
![Image 02](https://github.com/caiomcg/ffins/blob/master/images/ffmpeg-repo-releases.png)

The Zip or Tar version of the release can be downloaded directly from the github page, however cloning the github project
and moving to the tag is the recommended way of doing it.

```sh
$ git clone --branch 'release/4.1' https://github.com/FFmpeg/FFmpeg ffmpeg 
```

This will create a directory called ffmpeg on your system.

## Downloading the dependencies

The dependencies of the project lean on the type of application you will build, note that the license
may change depending on what is enable during the configuration period. An FFmpeg build with GPL V3 may
taint the code that you will be developing making it open source which may not be what you want. For
commercial use focus on an FFmpeg version using LGPL V3.

The dependencies can be downloaded and compiled manually from their project repositories but, for simplicity we will
use a package manager to fetch them.

For MacOs there are two options [macports](https://www.macports.org/) and [homebrew](https://brew.sh/) which I recommend.
For Linux distros the package manager depend on the distribution itself, for Fedora [Yum](https://en.wikipedia.org/wiki/Yum_(software)) is the 
default manager, for Arch [Pacman](https://wiki.archlinux.org/index.php/pacman) and for Debian/Ubuntu distros [apt](https://en.wikipedia.org/wiki/APT_(Package_Manager)). In this tutorial we will be using a computer with MacOS, however the tutorial will be focused for Ubuntu Linux.

Before installing the dependencies it is interesting to install autotools and yasm which are in order the build tools for unix
and an assembler.

```sh
$ sudo apt -y install yasm autotools
```

For this project we will use h264, h265 and VP9. To install them through apt invoke:

```sh
$ sudo apt -y install libx264-dev libx265-dev libvpx-dev
```

### Generating the configure

Before compiling ffmpeg the configure script needs to be invoked to setup the dependencies that you will assign to the lib. For information on what can be passed to the configure call.

**DO NOT FORGET TO MOVE TO THE FFMPEG FOLDER**

```sh
$ ./configure --help
```

Now we can enable or disable dependencies for this simple tutorial we will use the codecs cited above.

```sh
$ ./configure --enable-gpl --enable-libx264 --enable-libx265 --enable-libvpx
```

After the configure is executed a large output will appear on the terminal you can read it and check if the dependencies you have enabled/disabled have been set appropriately. You can also see the license of the build at the bottom of the file.

### Compiling

To compile invoke make at the root of the project. To accelerate the build invoke make with the -j option which indicates the amount of threads to use while compiling which, by default is one. I will use 4 thread as my computer has 4 cores.

```sh
$ make -j 4
```

### Installing

To install invoke make with the install target. This will install ffmpeg headers and libs on your environment (root may be required).

```sh
$ sudo make install
```

### Validating the installation

To check wether FFmpeg has been appropriately installed navigate to /usr/local/include and look for libavcodec if there are headers than it was properly installed.

To finalize the installation invoke [ldconfig](http://man7.org/linux/man-pages/man8/ldconfig.8.html) to revalidate the shared libraries cache.

```sh
$ sudo ldconfig
```



